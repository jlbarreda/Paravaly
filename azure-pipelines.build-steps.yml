# https://aka.ms/yaml

steps:
- task: RegexReplace@3
  displayName: 'Set Version'
  inputSearchPattern: '**/*.csproj'
  findRegex: '<VersionPrefix></VersionPrefix>'
  replaceRegex: '<VersionPrefix>$(version)</VersionPrefix>'

- script: |
    dotnet build --configuration $(buildConfiguration)
    dotnet test test\Paravaly.Tests\Paravaly.Tests.csproj --configuration $(buildConfiguration) --logger trx --no-build
    dotnet pack src\Paravaly

- task: PublishTestResults@2
  condition: succeededOrFailed()
  inputs:
    testRunner: VSTest
    testResultsFiles: '**/*.trx'